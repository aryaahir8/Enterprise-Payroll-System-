       IDENTIFICATION DIVISION.
       PROGRAM-ID. PAYROLL.
       AUTHOR. Cascade.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT EMPLOYEE-FILE ASSIGN TO EMPLOYEE-VSAM
               ORGANIZATION IS INDEXED
               ACCESS MODE IS SEQUENTIAL
               RECORD KEY IS EMPLOYEE-ID.
           SELECT OUTPUT-FILE ASSIGN TO PAYROLL-OUT.

       DATA DIVISION.
       FILE SECTION.

       FD  EMPLOYEE-FILE
           RECORDING MODE IS V
           BLOCK CONTAINS 0 RECORDS.

       01  EMPLOYEE-RECORD.
           05  EMPLOYEE-ID         PIC X(06).
           05  EMPLOYEE-NAME       PIC X(30).
           05  HOURS-WORKED       PIC 9(03).
           05  HOURLY-RATE        PIC 9(04)V99.

       FD  OUTPUT-FILE.

       01  OUTPUT-RECORD.
           05  EMPLOYEE-ID-OUT    PIC X(06).
           05  EMPLOYEE-NAME-OUT  PIC X(30).
           05  GROSS-PAY-OUT      PIC 9(06)V99.
           05  NET-PAY-OUT        PIC 9(06)V99.

       WORKING-STORAGE SECTION.
       77  EOF-SWITCH            PIC X VALUE 'N'.
       77  GROSS-PAY             PIC 9(06)V99.
       77  TAX-AMOUNT           PIC 9(06)V99.
       77  INSURANCE-AMOUNT      PIC 9(06)V99.
       77  NET-PAY               PIC 9(06)V99.

       PROCEDURE DIVISION.
       MAIN-PROCESS.
           OPEN INPUT EMPLOYEE-FILE
           OPEN OUTPUT OUTPUT-FILE

           PERFORM UNTIL EOF-SWITCH = 'Y'
               READ EMPLOYEE-FILE
                   AT END
                       MOVE 'Y' TO EOF-SWITCH
                   NOT AT END
                       PERFORM CALCULATE-PAY
                       PERFORM WRITE-OUTPUT
               END-READ
           END-PERFORM

           CLOSE EMPLOYEE-FILE
           CLOSE OUTPUT-FILE
           STOP RUN.

       CALCULATE-PAY.
           MULTIPLY HOURS-WORKED BY HOURLY-RATE GIVING GROSS-PAY
           MULTIPLY GROSS-PAY BY 0.20 GIVING TAX-AMOUNT
           MULTIPLY GROSS-PAY BY 0.05 GIVING INSURANCE-AMOUNT
           SUBTRACT TAX-AMOUNT INSURANCE-AMOUNT FROM GROSS-PAY GIVING NET-PAY.

       WRITE-OUTPUT.
           MOVE EMPLOYEE-ID TO EMPLOYEE-ID-OUT
           MOVE EMPLOYEE-NAME TO EMPLOYEE-NAME-OUT
           MOVE GROSS-PAY TO GROSS-PAY-OUT
           MOVE NET-PAY TO NET-PAY-OUT
           WRITE OUTPUT-RECORD.
